(this.webpackJsonplicense=this.webpackJsonplicense||[]).push([[0],{21:function(e,t,a){e.exports=a(49)},28:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(3),i=a.n(o),l=(a(28),a(1)),c=a.n(l),s=a(5),p=(a(30),a(31),a(32),a(4)),u=a.n(p),d=a(17),m=a(18),g=a(20),h=a(19),E="",f=r.a.createElement("div",null,r.a.createElement("div",{className:"input-group mb-3",id:"licenseCodeRef"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("br",null),r.a.createElement("span",{className:"input-group-text",id:""},"License Code"),r.a.createElement("br",null)),r.a.createElement("input",{type:"text",placeholder:"Enter License Code",className:"form-control",id:"licenseCode"})),r.a.createElement("br",null),r.a.createElement("button",{type:"button",id:"getLicenseButton",className:"btn btn-primary",onClick:y},"Get License")),v=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("div",{className:"lic"},r.a.createElement("div",{className:"licArea"},r.a.createElement("div",{style:{width:"100vh",height:"100vh",borderWidth:"0px"}},r.a.createElement("div",{className:"center"},r.a.createElement("img",{src:"./img/axis.svg",height:"100",alt:""}),r.a.createElement("br",null),r.a.createElement("div",{id:"license"},r.a.createElement("br",null),r.a.createElement("p",null,this.props.message))))))))}}]),a}(r.a.Component);function y(){return b.apply(this,arguments)}function b(){return(b=Object(s.a)(c.a.mark((function e(){var t,a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.a.render(r.a.createElement(v,{message:"Retrieving license key. Please wait ..."}),document.getElementById("root")),"free"===C&&(t='{"applicationId":"'+S+'","deviceId":"'+E+'","licenseType":1}'),a={method:"POST",crossDomain:!0,url:"https://gateway.api.axis.com/info-ext/acap/aca/v2/licensekey",data:t,dataType:"json",headers:{Authorization:"Bearer 2f742d39-1251-30bc-ba38-bc460e820596","Content-Type":"application/json"}},e.next=5,u()(a).catch((function(e){var t="Error! Code: "+e.response.status+" Message: "+e.response.data.originalTrace;console.log(t),i.a.render(r.a.createElement(v,{message:t,licStatus:f}),document.getElementById("root"))}));case 5:n=e.sent,console.log(n.status),console.log(n.data),200===n.status?x(n.data):alert("Error receiving license key, install through Axis Device Management or the ACAP List page");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=Object(s.a)(c.a.mark((function e(t){var a,n,o,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.a.render(r.a.createElement(v,{message:"Installing license key. Please wait ...",licStatus:f}),document.getElementById("root")),console.log("LR = "+t.xml),void 0===t.xml){e.next=14;break}return a=new FormData,n=new Blob([t.xml],{type:"application/octet-stream"}),a.append("lic_data",n,"key.lic"),o={method:"POST",url:"/axis-cgi/applications/license.cgi?action=uploadlicensekey&package="+O,data:a},e.next=9,u()(o);case 9:l=e.sent,console.log("Response: "+l.status),l.data.includes("OK")?(console.log("License key installed"),I(),w()):(l.data.includes("21")&&(console.log("Error: Invalid license key file."),alert("Error: Invalid license key file.")),l.data.includes("22")&&(console.log("Error: File upload failed."),alert("Error: File upload failed.")),l.data.includes("23")&&(console.log("Error: Failed to remove the license key file."),alert("Error: Failed to remove the license key file.")),l.data.includes("24")&&(console.log("Error: The application is not correctly installed"),alert("Error: The application is not correctly installed")),l.data.includes("25")&&(console.log("Error: The key\u2019s application ID does not match the installed application."),alert("Error: The key\u2019s application ID does not match the installed application.")),l.data.includes("26")&&(console.log("Error: The license key cannot be used with this version of the application."),alert("Error: The license key cannot be used with this version of the application.")),l.data.includes("27")&&(console.log("Error: Failed to connect to Axis online service."),alert("Error: Failed to connect to Axis online service.")),l.data.includes("28")&&(console.log("Error: Failed to receive license from Axis online service."),alert("Error: Failed to receive license from Axis online service.")),l.data.includes("29")&&(console.log("Error: Bad configuration file for the application."),alert("Error: Bad configuration file for the application.")),l.data.includes("30")&&(console.log("Error: Wrong serial number."),alert("Error: Wrong serial number.")),l.data.includes("31")&&(console.log("Error: The license key has expired."),alert("Error: The license key has expired."))),e.next=16;break;case 14:console.log("Error receiving license key, install through Axis Device Management or the ACAP List page"),alert("Error receiving license key, install through Axis Device Management or the ACAP List page");case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return T.apply(this,arguments)}function T(){return(T=Object(s.a)(c.a.mark((function e(){var t,n,o,l,s,p,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(),t={method:"GET",url:"/axis-cgi/applications/list.cgi"},e.next=4,u()(t);case 4:for(n=e.sent,console.log(n.data),o=a(16),l=(new o).parseFromString(n.data),console.log(l),s=l.getElementsByTagName("application").length,console.log("Installed Apps: "+s),p=0,p=0;p<s;p++)d=l.getElementsByTagName("application")[p].attributes.License,l.getElementsByTagName("application")[p].attributes.Name===O&&("Missing"===d&&(console.log("Missing license."),"free"===C&&y(),i.a.render(r.a.createElement(v,{message:"A license key needs to be installed.",licStatus:f}),document.getElementById("root"))),"Valid"===d&&(console.log("Valid license."),F(),i.a.render(r.a.createElement(v,{message:"Loading ..."}),document.getElementById("root"))),"Invalid"===d&&(console.log("Invalid license."),i.a.render(r.a.createElement(v,{message:"Invalid license.",licStatus:f}),document.getElementById("root"))));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return N.apply(this,arguments)}function N(){return(N=Object(s.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",url:"/axis-cgi/param.cgi?action=list&group=Properties.System.SerialNumber"},e.next=3,u()(t);case 3:a=e.sent,E=a.data.split("=")[1].replace("\n","").trim(),console.log("serial number: "+E);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return B.apply(this,arguments)}function B(){return(B=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",url:"/axis-cgi/applications/control.cgi?action=restart&package="+O.toLowerCase()},e.next=3,u()(t);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C="free",O="tailscale_vpn",S="414812",j="Tailscale VPN",L=document.createElement("link");function F(){return P.apply(this,arguments)}function P(){return(P=Object(s.a)(c.a.mark((function e(){var t,n,r,o,i,l,s,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("In startACAP"),t={method:"GET",url:"/axis-cgi/applications/list.cgi"},e.next=4,u()(t);case 4:n=e.sent,console.log(n.data),r=a(16),o=(new r).parseFromString(n.data),console.log(o),i=o.getElementsByTagName("application").length,console.log("Installed Apps: "+i),l=0,l=0;case 13:if(!(l<i)){e.next=30;break}if(s=o.getElementsByTagName("application")[l].attributes.Status,o.getElementsByTagName("application")[l].attributes.Name!==O){e.next=27;break}if("Running"!==s){e.next=21;break}console.log(j+" is running"),window.location="/local/tailscale_vpn/logs.html",e.next=27;break;case 21:return console.log(j+" is NOT running"),console.log(j+" is Starting"),p={method:"GET",url:"/axis-cgi/applications/control.cgi?action=start&package="+O},e.next=26,u()(p).then((function(e){console.log(e),console.log("Response from tailscale_vpn acap: "+e.data),window.location="/local/tailscale_vpn/logs.html"}));case 26:e.sent;case 27:l++,e.next=13;break;case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}L.rel="stylesheet",L.href="./css/semantic.min.css",document.head.appendChild(L);var D=function(){return w(),r.a.createElement("div",null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.b598e911.chunk.js.map